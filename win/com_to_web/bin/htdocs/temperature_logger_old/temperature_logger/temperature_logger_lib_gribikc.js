'use strict';
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	class arduino_termo_pressure_gr{
		constructor(hub){
			this.parser_data_array=new Array();
			this.hub_handler=hub;
			
			this.speed=0;
		}
		//////////
		//xdstartjson:{
		//}:xdstopjson
		parser_data(stream){
			//console.log(stream);
			if(stream["type"]=="error"){
				//!!!key_array_to_inner(stream,"error_log");
			}else if(stream["type"]=="bmp_cur"){
				//!!!document.getElementById("cur_temp").innerHTML= "Температура : "	+stream["Temperature"]+" градусов.<br>";
				//!!!document.getElementById("cur_temp").innerHTML+="Давление : "	+(stream["Pressure"]*7.501/10).toPrecision(5)+" мм.Р.ст.<br>";
				
				document.getElementById("in_air_temperature").innerHTML=stream["Temperature"];
				document.getElementById("in_air_pressure").innerHTML=(stream["Pressure"]*7.501/10).toPrecision(5);
			}else{
				//!!!key_array_to_inner(stream,"simple_test");
			}
		}
	}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	class set_snmp_param{
		constructor(url,oid,arr,fbf,params) {
			this.params={//location.hostname
				url   : url,
				url_w : '',//(document.location.protocol=="file:" ? "http://localhost:3128" : "" ) + '/W/COM/28/57600/',//'http://localhost:3128/W/COM/28/57600/',
				post_data:new Uint8Array( snmp_query(oid,0,JSON.stringify(arr)) ),//snmp_q_t_arr,
				mime_type:'text/plain; charset=x-user-defined',
				
				name:'',
				parser: new snmp_parser_gr( new json_parser_gr( fbf ) ),//array_data_to_log_gr
				
				flush_en:false,
				auto_start:true,
				
				status_en:false,
					status_timer:1000,
					status_div:"sys_status",
					status_div_status_css:"xmlhttprq_stream_gr_status",
					status_div_stat_css:"xmlhttprq_stream_gr_stat",
				
				reload_en:false,
					reload_time:1000,
				
				timeout_en:true,
					timeout_time:5000
			};
			for(var key in params) {
				this.params[key]=params[key];
			}
		}
	}
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	class get_snmp_param{
		constructor(url,oid,fbf,params) {
			this.params={//location.hostname
				url   : url,
				url_w : '',//(document.location.protocol=="file:" ? "http://localhost:3128" : "" ) + '/W/COM/28/57600/',//'http://localhost:3128/W/COM/28/57600/',
				post_data:new Uint8Array( snmp_query(oid,1,null) ),//snmp_q_t_arr,
				mime_type:'text/plain; charset=x-user-defined',
				
				name:'',
				parser: new snmp_parser_gr( new json_parser_gr( fbf ) ),//array_data_to_log_gr//new array_data_to_log_gr()
				
				flush_en:false,
				auto_start:true,
				
				status_en:false,
					status_timer:1000,
					status_div:"sys_status",
					status_div_status_css:"xmlhttprq_stream_gr_status",
					status_div_stat_css:"xmlhttprq_stream_gr_stat",
				
				reload_en:false,
					reload_time:1000,
				
				timeout_en:true,
					timeout_time:5000
			};
			for(var key in params) {
				this.params[key]=params[key];
			}
		}
	}
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	class set_get_snmp{
		constructor(url,oid,arr,fbf) {
			this.url=url;
			this.oid=oid;
			this.arr=arr;
			this.fbf=fbf;
			//new xmlhttprq_stream_gr(new set_snmp_param(url,oid,arr,this.call_get()).params);
			new xmlhttprq_stream_gr(new set_snmp_param(url,oid,arr,this).params);//array_to_to_to_gr()
		}
		parser_data(){
			new xmlhttprq_stream_gr(new get_snmp_param(this.url, this.oid, this.fbf).params);
		}
	}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	class snmp_test_temperature_gr{
		constructor(div){
			//this.hub_handler=hub;
			this.div=div;
		}
		//////////
		parser_data(stream){
			//console.log(stream);
			//key_array_to_inner(stream,this.div);
			document.getElementById(this.div).innerHTML='';
			for(var i=0;i<stream['temperatures'].length;i++){
				document.getElementById(this.div).innerHTML+='||'+stream['temperatures'][i]['slot']+':'+(stream['temperatures'][i]['temperature']).toPrecision(3);
			}
		}
	}
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	class get_temperature_request_param{
		constructor(name,url,div,arr) {
			this.params={//location.hostname
				url   : url,
				url_w : '',//(document.location.protocol=="file:" ? "http://localhost:3128" : "" ) + '/W/COM/28/57600/',//'http://localhost:3128/W/COM/28/57600/',
				post_data:new Uint8Array(snmp_query("1.3.6.1.4.1.23512.1001.112.80.8080.211.1.0",1)),//snmp_q_t_arr,
				mime_type:'text/plain; charset=x-user-defined',
				
				name:name,
				parser: new snmp_parser_gr( new json_parser_gr(new snmp_test_temperature_gr(div) ) ),
				
				flush_en:false,
				auto_start:true,
				
				status_en:false,
					status_timer:1000,
					status_div:"sys_status",
					status_div_status_css:"xmlhttprq_stream_gr_status",
					status_div_stat_css:"xmlhttprq_stream_gr_stat",
				
				reload_en:true,
					reload_time:1000,
				
				timeout_en:true,
					timeout_time:3000
			};
			for(var key in arr) {
				this.params[key]=arr[key];
			}
		}
	}
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////